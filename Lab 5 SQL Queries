--Pearl Amin 
--Lab 5 SQL Queries - The Joins Three-uel 
--Oct 9th, 2017 

--Question 5-- 
select count(o.ordno), c.name, a.name 
from orders o inner join customers c on o.cid = c.cid 
			  inner join agents a on o.aid = a.aid 
              --everything from orders,customers,agents
where o.cid in (select c1.cid              
                from customers as c1, agents as a 
                where c.city = a.city)
                and  o.aid in (select a1.aid 
                               from agents as a1, customers as c2 
                               where c2.city = a1.city)
Group By c.name, a.name
Having count (o.ordno) >= 1 
--having ordered one or more orders 
;

--Question 6-- 
Select c.name, a.name, c.city, a.city  
From customers c full outer join agents a on a.city = c.city  
Where a.city = c.city 
;
